<!doctype html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WaterGuard</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link rel="stylesheet" href="css/monitoring.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=do+Hyeon&family=Jua&family=Noto+Sans+KR:wght@100&display=swap"
	rel="stylesheet">
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
	  <style>
	  canvas {
      max-width: 100%;
      max-height: 100%;
    }
    
  </style>
</head>

<body>
	<!-- header Navbar 시작 -->
	<div id="wrap">

		<div id="header">
			<nav class="navbar sticky-top ">
				<div class="container-fluid col-2">
					<a href="goMain.do"><img
						src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FmlsI7%2Fbtr0BB7bnSk%2FKiqvCvFrLHKhqg8WS3T3Y1%2Fimg.png"
						width="200" height="50" class="d-inline-block align-text-top"></a>
					<h3 class="m-0 title-1">양식장 모니터링</h3>
				</div>
				<div class="container-fluid col-2"></div>
				<div class="container-fluid col-2">
					<div class="item menu1 menu">
						<a href="goMonitoring.do"> <img
							src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fcj7reU%2Fbtr0Ayh4BNO%2FLOJ4gjo2ZmmAK78NuJcVtk%2Fimg.png"
							width="20" height="20"> 양식장 모니터링
						</a>
					</div>
					<div class="item menu2 menu">
						<a href="goPredict.do"> <img
							src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FrmAhC%2Fbtr0BCYQeaQ%2Fw0Jqj1s3HSRrHRuIvJK1J1%2Fimg.png"
							width="20" height="20"> 수질 예측
						</a>
					</div>
					<div class="item menu3 menu">
						<a href="goSetting.do"> <img
							src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fq0oYv%2Fbtr0w2rg3Fl%2FZKL1SrUPc49KPmkRdcfK8K%2Fimg.png"
							width="20" height="20"> 환경 설정
						</a>
					</div>
					<ul class="nav-item dropdown">
						<h5 class="m-0">
							<a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink"
								role="button" data-bs-toggle="dropdown" aria-expanded="false">company
							</a>
							<ul class="dropdown-menu"
								aria-labelledby="navbarDropdownMenuLink">
								<li><a class="dropdown-item" href="#">회사이름</a></li>
								<li><a class="dropdown-item" href="logout.do">로그아웃</a></li>
							</ul>
						</h5>
					</ul>
				</div>
				<div class="container-fluid col-6"></div>
			</nav>
		</div>
		<!-- header Navbar 끝-->

		<!-- 본문 시작 -->
		<div id="container">
			<!-- 본화면 시작 -->
			<div id="main-1" class="main">
				<div class="rectangle-1">
					<div id="btn-container">
						<button class="btn" id="next-page">
							<i class="fa-solid fa-right-long fa-3x"></i>
						</button>
						<!-- <button class="btn"><i class="fa-solid fa-left-long fa-3x"></i></button> -->
					</div>
					
					
					<div class="rectangle-2">
						<div class="tank">
							<div class="tct">양식장 수조 1</div>
							<div class="warning">
								<div class="wl"></div>
								<div class="tctm">2023년 2월 27일 PM 04:55</div>
							</div>
						</div>
						
						<div class="rectangle-3">
							<div class="rectangle-gp">
								<div class="ondo-gp"><canvas id="Chart_temp"></canvas></div>
								<div class="do-gp"><canvas id="Chart_do"></canvas></div>
								<div class="ph-gp"><canvas id="Chart_ph"></canvas></div>
								<div class="salt-gp"><canvas id="Chart_salt"></canvas></div>
							</div>
							<div class="rectangle-data">
								<div class="ondo">
									<div class="rectangle-value">온도</div>
									<div class="ondo-n"></div>
								</div>
								<hr class="line-1"></hr>
								<div class="do">
									<div class="rectangle-value">do</div>
									<div class="do-n"></div>
								</div>
								<hr class="line-1"></hr>
								<div class="ph">
									<div class="rectangle-value">ph</div>
									<div class="ph-n"></div>
								</div>
								<hr class="line-1"></hr>
								<div class="salt">
									<div class="rectangle-value">염분</div>
									<div class="salt-n"></div>
								</div>
							</div>
						</div>
					</div>
					
					
					
					
					
					
					
					
					
					
					
					<div class="rectangle-2">
						<div class="tank">
							<div class="tct">양식장 수조 2</div>
							<div class="warning">
								<div class="wl"></div>
								<div class="tctm">2023년 2월 27일 PM 04:55</div>
							</div>
						</div>
						<div class="rectangle-3">
							<div class="rectangle-gp">
								<div class="ondo-gp"></div>
								<div class="do-gp"></div>
								<div class="ph-gp"></div>
								<div class="salt-gp"></div>
							</div>
							<div class="rectangle-data">
								<div class="ondo">
									<div class="rectangle-value">온도</div>
									<div class="ondo-n">12.20 °C</div>
								</div>
								<hr class="line-1"></hr>
								<div class="do">
									<div class="rectangle-value">do</div>
									<div class="do-n">12 ppm</div>
								</div>
								<hr class="line-1"></hr>
								<div class="ph">
									<div class="rectangle-value">ph</div>
									<div class="ph-n">7.5 ph</div>
								</div>
								<hr class="line-1"></hr>
								<div class="salt">
									<div class="rectangle-value">염분</div>
									<div class="salt-n">25.30 psu</div>
								</div>
							</div>
						</div>
					</div>
					<div class="rectangle-2">
						<div class="tank">
							<div class="tct">양식장 수조 3</div>
							<div class="warning">
								<div class="wl"></div>
								<div class="tctm">2023년 2월 27일 PM 04:55</div>
							</div>
						</div>
						<div class="rectangle-3">
							<div class="rectangle-gp">
								<div class="ondo-gp"></div>
								<div class="do-gp"></div>
								<div class="ph-gp"></div>
								<div class="salt-gp"></div>
							</div>
							<div class="rectangle-data">
								<div class="ondo">
									<div class="rectangle-value">온도</div>
									<div class="ondo-n">12.20 °C</div>
								</div>
								<hr class="line-1"></hr>
								<div class="do">
									<div class="rectangle-value">do</div>
									<div class="do-n">12 ppm</div>
								</div>
								<hr class="line-1"></hr>
								<div class="ph">
									<div class="rectangle-value">ph</div>
									<div class="ph-n">7.5 ph</div>
								</div>
								<hr class="line-1"></hr>
								<div class="salt">
									<div class="rectangle-value">염분</div>
									<div class="salt-n">25.30 psu</div>
								</div>
							</div>
						</div>
					</div>
					<div class="rectangle-2">
						<div class="tank">
							<div class="tct">양식장 수조 4</div>
							<div style="display: flex">
								<div class="wl"></div>
								<div class="tctm">2023년 2월 27일 PM 04:55</div>
							</div>
						</div>
						<div class="rectangle-3">
							<div class="rectangle-gp">
								<div class="ondo-gp"></div>
								<div class="do-gp"></div>
								<div class="ph-gp"></div>
								<div class="salt-gp"></div>
							</div>
							<div class="rectangle-data">
								<div class="ondo">
									<div class="rectangle-value">온도</div>
									<div class="ondo-n">12.20 °C</div>
								</div>
								<hr class="line-1"></hr>
								<div class="do">
									<div class="rectangle-value">do</div>
									<div class="do-n">12 ppm</div>
								</div>
								<hr class="line-1"></hr>
								<div class="ph">
									<div class="rectangle-value">ph</div>
									<div class="ph-n">7.5 ph</div>
								</div>
								<hr class="line-1"></hr>
								<div class="salt">
									<div class="rectangle-value">염분</div>
									<div class="salt-n">25.30 psu</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- 본화면 중간 -->
			<div id="main-2" class="main">
				<div class="rectangle-1">
					<div id="btn-container">
						<button class="btn" id="before-page">
							<i class="fa-solid fa-left-long fa-3x"></i>
						</button>
					</div>
					<div class="rectangle-2">
						<div class="tank">
							<div class="tct">양식장 수조 5</div>
							<div class="warning">
								<div class="wl"></div>
								<div class="tctm">2023년 2월 27일 PM 04:55</div>
							</div>
						</div>
						<div class="rectangle-3">
							<div class="rectangle-gp">
								<div class="ondo-gp"></div>
								<div class="do-gp"></div>
								<div class="ph-gp"></div>
								<div class="salt-gp"></div>
							</div>
							<div class="rectangle-data">
								<div class="ondo">
									<div class="rectangle-value">온도</div>
									<div class="ondo-n">12.20 °C</div>
								</div>
								<hr class="line-1"></hr>
								<div class="do">
									<div class="rectangle-value">do</div>
									<div class="do-n">12 ppm</div>
								</div>
								<hr class="line-1"></hr>
								<div class="ph">
									<div class="rectangle-value">ph</div>
									<div class="ph-n">7.5 ph</div>
								</div>
								<hr class="line-1"></hr>
								<div class="salt">
									<div class="rectangle-value">염분</div>
									<div class="salt-n">25.30 psu</div>
								</div>
							</div>
						</div>
					</div>
					<div class="rectangle-2">
						<div class="tank">
							<div class="tct">양식장 수조 6</div>
							<div class="warning">
								<div class="wl"></div>
								<div class="tctm">2023년 2월 27일 PM 04:55</div>
							</div>
						</div>
						<div class="rectangle-3">
							<div class="rectangle-gp">
								<div class="ondo-gp"></div>
								<div class="do-gp"></div>
								<div class="ph-gp"></div>
								<div class="salt-gp"></div>
							</div>
							<div class="rectangle-data">
								<div class="ondo">
									<div class="rectangle-value">온도</div>
									<div class="ondo-n">12.20 °C</div>
								</div>
								<hr class="line-1"></hr>
								<div class="do">
									<div class="rectangle-value">do</div>
									<div class="do-n">12 ppm</div>
								</div>
								<hr class="line-1"></hr>
								<div class="ph">
									<div class="rectangle-value">ph</div>
									<div class="ph-n">7.5 ph</div>
								</div>
								<hr class="line-1"></hr>
								<div class="salt">
									<div class="rectangle-value">염분</div>
									<div class="salt-n">25.30 psu</div>
								</div>
							</div>
						</div>
					</div>
					<div class="rectangle-2">
						<div class="tank">
							<div class="tct">양식장 수조 7</div>
							<div class="warning">
								<div class="wl"></div>
								<div class="tctm">2023년 2월 27일 PM 04:55</div>
							</div>
						</div>
						<div class="rectangle-3">
							<div class="rectangle-gp">
								<div class="ondo-gp"></div>
								<div class="do-gp"></div>
								<div class="ph-gp"></div>
								<div class="salt-gp"></div>
							</div>
							<div class="rectangle-data">
								<div class="ondo">
									<div class="rectangle-value1">온도</div>
									<div class="ondo-n">12.20 °C</div>
								</div>
								<hr class="line-1"></hr>
								<div class="do">
									<div class="rectangle-value">do</div>
									<div class="do-n">12 ppm</div>
								</div>
								<hr class="line-1"></hr>
								<div class="ph">
									<div class="rectangle-value">ph</div>
									<div class="ph-n">7.5 ph</div>
								</div>
								<hr class="line-1"></hr>
								<div class="salt">
									<div class="rectangle-value">염분</div>
									<div class="salt-n">25.30 psu</div>
								</div>
							</div>
						</div>
					</div>
					<div class="rectangle-2">
						<div class="tank">
							<div class="tct">양식장 수조 8</div>
							<div class="warning">
								<div class="wl"></div>
								<div class="tctm">2023년 2월 27일 PM 04:55</div>
							</div>
						</div>
						<div class="rectangle-3">
							<div class="rectangle-gp">
								<div class="ondo-gp"></div>
								<div class="do-gp"></div>
								<div class="ph-gp"></div>
								<div class="salt-gp"></div>
							</div>
							<div class="rectangle-data">
								<div class="ondo">
									<div class="rectangle-value">온도</div>
									<div class="ondo-n">12.20 °C</div>
								</div>
								<hr class="line-1"></hr>
								<div class="do">
									<div class="rectangle-value">do</div>
									<div class="do-n">12 ppm</div>
								</div>
								<hr class="line-1"></hr>
								<div class="ph">
									<div class="rectangle-value">ph</div>
									<div class="ph-n">7.5 ph</div>
								</div>
								<hr class="line-1"></hr>
								<div class="salt">
									<div class="rectangle-value">염분</div>
									<div class="salt-n">25.30 psu</div>
								</div>
							</div>
						</div>
					</div>
				</div>










			</div>
			<!-- 본화면 끝 -->







		</div>
		<!-- 본문 끝 -->
	</div>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
	
	<script src="js/monitoring.js"></script>
	<script src="https://kit.fontawesome.com/5ecdf6234c.js"
		crossorigin="anonymous"></script>
		
	 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" type="text/javascript"></script>
	
	<script type="text/javascript">
	$.ajax({
	    url : "test",
	    
	    success : function(res){
	        // 3. 응답받은 데이터를 console 출력
	        var count = 0;
	        console.log(res)
	        setInterval(() => {
	        	 console.log(res[count])
	        	 time_data = res[count].record_DATE.split('T')[1].split('.')[0]
	            $('.ondo-n').html("")
	            $('.do-n').html("")
	            $('.temp-n').html("")
	            $('.salt-n').html("")
	            $('.ph-n').html("")
	            
	       	 let do_do = `<h5>`+res[count].do+`ppm</h5>`;
	     		let ph=`<h5>`+res[count].ph+`ph</h5>`;
	     		 let temp=`<h5>`+res[count].temp+`°C</h5>`;
	     		 let salt=`<h5>`+res[count].salt+`psu</h5>`;
	     		
	     		
	            $('.ondo-n').append(temp);
	            $('.do-n').append(do_do);
	            $('.temp-n').append(temp);
	            $('.salt-n').append(salt);
	            $('.ph-n').append(ph);
	            count++
	        }, 3000
	              
	        );
	        
	        // 차트 초기화
	          let labels = [];
	          const data0 = {
	            labels: labels,
	            datasets: [{
	              label: 'DO',
	              data: [],
	              fill: false,
	              backgroundColor: [],
	              borderColor: [],
	              tension: 0.1,
	              borderWidth: 1
	            }]
	          };
	          

	          const data1 = {
	            labels: labels,
	            datasets: [{
	              label: 'PH',
	              data: [],
	              fill: false,
	              backgroundColor: [],
	              borderColor: [],
	              tension: 0.1
	            }]
	          };
	          const data2 = {
	            labels: labels,
	            datasets: [{
	              label: 'TEMP',
	              data: [],
	              fill: false,
	              backgroundColor: [],
	              borderColor: [],
	              tension: 0.1
	            }]
	          };
	          const data3 = {
	            labels: labels,
	            datasets: [{
	              label: 'SALT',
	              data: [],
	              fill: false,
	              backgroundColor: [],
	              borderColor: [],
	              tension: 0.1
	            }]
	          };

	          let hiddenLabel = [];
	          let config0 = {
	            type: 'line',
	            data: data0,
	            options: {
	              scales: {
	                x: {
	                  tick: {
	                    display: false,
	                    callback: function(label, index, labels) {
	                      return hiddenLabel;
	                    }
	                  }
	                }
	              }
	            }
	          };
	          let config1 = {
	            type: 'line',
	            data: data1,
	            options: {
	              scales: {
	                x: {
	                  tick: {
	                    display: false,
	                    callback: function(label, index, labels) {
	                      return hiddenLabel;
	                    }
	                  }
	                }
	              }
	            }
	          };
	          let config2 = {
	            type : 'line',
	            data: data2,
	            options: {
	              scales: {
	                x: {
	                  tick:{
	                    display: false,
	                    callback: function(label, index, labels) {
	                      return hiddenLabel;
	                    }
	                  }
	                }
	              }
	            }
	          };
	          let config3 = {
	            type: 'line',
	            data: data3,
	            options: {
	              scales: {
	                x: {
	                  tick:{
	                    display: false,
	                    callback: function(label, index, labels) {
	                      return hiddenLabel;
	                    }
	                  }
	                }
	              }
	            }
	          };
	          let chart0 = new Chart(
	          document.getElementById('Chart_do'),
	          config0
	          );
	          let chart1 = new Chart(
	          document.getElementById('Chart_ph'),
	          config1
	          );
	          let chart2 = new Chart(
	          document.getElementById('Chart_temp'),
	          config2
	          );
	          let chart3 = new Chart(
	          document.getElementById('Chart_salt'),
	          config3
	          );
	        
	          

	          setInterval(()=> {
	          hiddenLabel.push("");
	        
	          if (data0.datasets[0].data.length > 12){
	            labels.shift();
	            data0.datasets[0].data.shift();
	            data0.datasets[0].backgroundColor.shift();
	            data0.datasets[0].borderColor.shift();
	            data1.datasets[0].data.shift();
	            data1.datasets[0].backgroundColor.shift();
	            data1.datasets[0].borderColor.shift();
	            data2.datasets[0].data.shift();
	            data2.datasets[0].backgroundColor.shift();
	            data2.datasets[0].borderColor.shift();
	            data3.datasets[0].data.shift();
	            data3.datasets[0].backgroundColor.shift();
	            data3.datasets[0].borderColor.shift();
	          }
	          labels.push(time_data);
	          data0.datasets[0].data.push(res[count].do);
	          data0.datasets[0].backgroundColor.push(3 >=res[count].do ? 'rgba(255, 0, 0)' : 'rgba(0, 255, 0)');
	          data0.datasets[0].borderColor.push(3 >= res[count].do ? 'rgba(255, 0, 0)' : 'rgba(0, 255, 0)');
	          data1.datasets[0].data.push(res[count].ph);
	          data1.datasets[0].backgroundColor.push(7.5 >= res[count].ph >= 8.5 ? 'rgba(255, 0, 0)' : 'rgba(0, 255, 0)');
	          data1.datasets[0].borderColor.push(7.5 >= res[count].ph >= 8.5 ? 'rgba(255, 0, 0)' : 'rgba(0, 255, 0)');
	          data2.datasets[0].data.push(res[count].temp);
	          data2.datasets[0].backgroundColor.push(25 >= res[count].temp >= 30 ? 'rgba(255, 0, 0)' : 'rgba(0, 255, 0)');
	          data2.datasets[0].borderColor.push(25 >= res[count].temp >= 30 ? 'rgba(255, 0, 0)' : 'rgba(0, 255, 0)');
	          data3.datasets[0].data.push(res[count].salt);
	          data3.datasets[0].backgroundColor.push(20 >= res[count].salt >= 34 ? 'rgba(255, 0, 0)' : 'rgba(0, 255, 0)');
	          data3.datasets[0].borderColor.push(20 >= res[count].salt >= 34 ? 'rgba(255, 0, 0)' : 'rgba(0, 255, 0)');

	          chart0.update();
	          chart1.update();
	          chart2.update();
	          chart3.update();
	          count++;
	          }, 3000); 
	        },
	        
	        
	  
	        
	   
	    error : function(){
	        console.log('요청실패');
	    }});    
	</script>
		
		
		
		
		
		
</body>
</html>